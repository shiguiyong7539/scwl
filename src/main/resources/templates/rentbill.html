<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=0" />
    <title>租金收入</title>
    <link href="css/main.css" rel="stylesheet" type="text/css" />
    <link href="css/style_sc.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="js/jquery.min.js"></script>

    <script type="text/javascript" src="js/plugins/spinner/ui.spinner.js"></script>
    <script type="text/javascript" src="js/plugins/spinner/jquery.mousewheel.js"></script>

    <script type="text/javascript" src="js/jquery-ui.min.js"></script>

    <script type="text/javascript" src="js/plugins/charts/excanvas.min.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.flot.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.flot.orderBars.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.flot.pie.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.flot.resize.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.sparkline.min.js"></script>

    <script type="text/javascript" src="js/plugins/forms/uniform.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.cleditor.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.validationEngine-en.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.validationEngine.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.tagsinput.min.js"></script>
    <script type="text/javascript" src="js/plugins/forms/autogrowtextarea.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.maskedinput.min.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.dualListBox.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.inputlimiter.min.js"></script>
    <script type="text/javascript" src="js/plugins/forms/chosen.jquery.min.js"></script>

    <script type="text/javascript" src="js/plugins/wizard/jquery.form.js"></script>
    <script type="text/javascript" src="js/plugins/wizard/jquery.validate.min.js"></script>
    <script type="text/javascript" src="js/plugins/wizard/jquery.form.wizard.js"></script>

    <script type="text/javascript" src="js/plugins/uploader/plupload.js"></script>
    <script type="text/javascript" src="js/plugins/uploader/plupload.html5.js"></script>
    <script type="text/javascript" src="js/plugins/uploader/plupload.html4.js"></script>
    <script type="text/javascript" src="js/plugins/uploader/jquery.plupload.queue.js"></script>

    <script type="text/javascript" src="js/plugins/tables/datatable.js"></script>
    <script type="text/javascript" src="js/plugins/tables/tablesort.min.js"></script>
    <script type="text/javascript" src="js/plugins/tables/resizable.min.js"></script>

    <script type="text/javascript" src="js/plugins/ui/jquery.tipsy.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.collapsible.min.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.prettyPhoto.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.progress.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.timeentry.min.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.colorpicker.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.breadcrumbs.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.sourcerer.js"></script>

    <script type="text/javascript" src="js/plugins/calendar.min.js"></script>
    <script type="text/javascript" src="js/plugins/elfinder.min.js"></script>
    <script type="text/javascript" src="js/layui.js"></script>
</head>

<body>

<!-- Left side content -->
<div id="leftSide">
    <div class="logo"><a href="#"><img src=" " alt="" /></a></div>

    <div class="sidebarSep mt0"></div>



    <!-- Left navigation -->
    <ul id="menu" class="nav">
        <li class="dash"><a href="#" onclick="index_html()" class="active"><span>首页</span></a></li>
        <li class="charts"><a href="#" title="" onclick="toggle('userManage')" class="exp"><span>系统管理</span></a>
            <ul class="sub ul_hidden" id="userManage">
                <li><a href="#" title="" onclick="hetong()">合同履行</a></li>
                <li><a href="#" title="" onclick="mangeState()">经营管理</a></li>
                <li><a href="#" title="" onclick="costManage()">预算执行</a></li>
                <li><a href="#" onclick="memberList()" title="">人事信息</a></li>
                <li><a href="#" title="" onclick="capitalposition()">资金状况</a></li>
            </ul>
        </li>

        <li class="charts"><a href="#" title="" onclick="toggle('asset')" class="exp"><span>租金管理</span></a>
            <ul class="sub ul_hidden" id="asset">
                <li><a href="#" title="" onclick="assetList()">资产列表</a></li>
                <li><a href="#" title="" onclick="lesseList()">租户列表</a></li>
                <li><a href="#" title="" onclick="leaseInfolist()">租约列表</a></li>
                <li><a href="#" title="" onclick="rentList()">租金收入</a></li>
            </ul>
        </li>

        <li class="charts"><a href="#" title="" onclick="toggle('taskManage')" class="exp"><span>任务管理</span></a>
            <ul class="sub ul_hidden" id="taskManage">
                <li><a href="#" title="" onclick="tasklist('综合部')">综合部</a></li>
                <li><a href="#" title="" onclick="tasklist('市场部')">市场部</a></li>
                <li><a href="#" title="" onclick="tasklist('财务部')">财务部</a></li>
                <li><a href="#" title="" onclick="tasklist('规建部')">规建部</a></li>
                <li><a href="#" title="" onclick="tasklist('金沙艺术中心')">金沙艺术中心</a></li>
            </ul>
        </li>

        <li class="charts"><a href="#" title="" onclick="toggle('fengKongManage')" class="exp"><span>风控管理</span></a>
            <ul class="sub ul_hidden" id="fengKongManage">
                <li><a href="#" title="" onclick="fengkong()">涉诉情况</a></li>
                <li><a href="#" title="" onclick="rectify()">内部监督情况</a></li>
            </ul>
        </li>
        <li class="charts"><a href="#" title="" onclick="toggle('role')" class="exp"><span>角色权限</span></a>
            <ul class="sub ul_hidden" id="role">
                <li><a href="#" title="" onclick="roleList()">角色</a></li>
                <li><a href="#" title="" onclick="authority()">权限</a></li>
            </ul>
        </li>
        <li class="tables"><a href="#" title="" onclick="toggle('myInfo')"  class="exp"><span>个人档案</span><strong></strong></a>
            <ul class="sub ul_hidden" id="myInfo">
                <li><a href="#" title="#" onclick="userInfo()" id="idNo"></a></li>
                <li><a href="#" title="#" onclick="userInfo()" id="idName"></a></li>
                <li class="last"><a href="#" title="" onclick="userInfo()" id="idPhone"></a></li>
            </ul>
        </li>

    </ul>
</div>


<!-- Right side -->
<div id="rightSide">

    <!-- Top fixed navigation -->
    <div class="topNav">
        <div class="wrapper">
            <div class="welcome"><a href="#" title=""><img src="images/userPic.png" alt="" /></a><span id="loginUser"></span></div>
            <div class="welcome"><a href="#" title=""></a><span id="messages" style="color: red"></span></div>
            <div class="userNav">
                <ul>
                    <li><a href="#" title=""><img src="images/icons/topnav/logout.png" alt="" /><span onclick="logOut()">退出</span></a></li>
                </ul>
            </div>
            <div class="clear"></div>
        </div>
    </div>

    <!-- Responsive header -->
    <div class="resp">
        <div class="respHead">
            <a href="#" title=""><img src="images/loginLogo.png" alt="" /></a>
        </div>

        <div class="cLine"></div>
        <div class="smalldd">
            <span class="goTo"><img src="images/icons/light/home.png" alt="" />Dashboard</span>
            <ul class="smallDropdown">
                <li><a href="#" title=""><img src="images/icons/light/home.png" alt="" />Dashboard</a></li>
                <li><a href="#" title=""><img src="images/icons/light/stats.png" alt="" />Statistics and charts</a></li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/pencil.png" alt="" />Forms stuff<strong>4</strong></a>
                    <ul>
                        <li><a href="#" title="">Form elements</a></li>
                        <li><a href="#" title="">Validation</a></li>
                        <li><a href="#" title="">WYSIWYG and file uploader</a></li>
                        <li class="last"><a href="#" title="">Wizards</a></li>
                    </ul>
                </li>
                <li><a href="#" title=""><img src="images/icons/light/users.png" alt="" />Interface elements</a></li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/frames.png" alt="" />Tables<strong>3</strong></a>
                    <ul>
                        <li><a href="#" title="">Static tables</a></li>
                        <li><a href="#" title="">Dynamic table</a></li>
                        <li class="last"><a href="#" title="">Sortable &amp; resizable tables</a></li>
                    </ul>
                </li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/fullscreen.png" alt="" />Widgets and grid<strong>2</strong></a>
                    <ul>
                        <li><a href="#" title="">Widgets</a></li>
                        <li class="last"><a href="#" title="">Grid</a></li>
                    </ul>
                </li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/alert.png" alt="" />Error pages<strong>6</strong></a>
                    <ul class="sub">
                        <li><a href="#" title="">403 page</a></li>
                        <li><a href="#" title="">404 page</a></li>
                        <li><a href="#" title="">405 page</a></li>
                        <li><a href="#" title="">500 page</a></li>
                        <li><a href="#" title="">503 page</a></li>
                        <li class="last"><a href="#" title="">Website is offline</a></li>
                    </ul>
                </li>
                <li><a href="#" title=""><img src="images/icons/light/files.png" alt="" />File manager</a></li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/create.png" alt="" />Other pages<strong>3</strong></a>
                    <ul>
                        <li><a href="#" title="">Typography</a></li>
                        <li><a href="#" title="">Calendar</a></li>
                        <li class="last"><a href="#" title="">Gallery</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="cLine"></div>
    </div>

    <!-- Title area -->
    <div class="titleArea">
        <div class="wrapper">
            <div class="pageTitle">
            </div>
            <div class="middleNav">

                <div class="clear"></div>
            </div>
            <div class="clear"></div>
        </div>
    </div>
    <div class="line"></div>
    <!-- Main content wrapper -->
    <div class="wrapper">

        <!-- Note -->
        <div class="nNote nInformation hideit">
            <p>亲爱的<strong>沙磁文旅 </strong>（Lv1，重庆市地区领导人）</p>
        </div>

        <!-- Widgets -->
        <div class="widgets">
            <div class="widget">
                <div class="layui-row">
                    <form class="layui-col-md12 x-so" id="formId">
                        资产名称: <input  style=" width: 10%;" type="text" name="assetName"  placeholder="名称" autocomplete="off" class="layui-input">
                        租户名称: <input  style=" width: 10%;" type="text" name="lesseeName"  placeholder="名称" autocomplete="off" class="layui-input">
                        <span>状态:</span>
                        <select name="status">
                            <option value=""></option>
                            <option value="1">已交</option>
                            <option value="2">欠费</option>
                            <option value="3">免租</option>
                        </select>
                        <div id="sousuo" class="sousuo" onclick="getBillList(1)" >搜索</div>
                    </form>
                </div>
                <div class="title"><img src="images/icons/dark/stats.png" alt="" class="titleIcon"><h6>租金信息</h6>
                    <div class="formAddEmp" style="float: left; margin-right: 5px;"><a href="#" onclick="exportBill()"><input type="submit" value="导出租金明细" class="redB"></a></div>
<!--                    <div class="formAddEmp" style="float: left; margin-right: 5px;"><input type="submit" onclick="addRentBill()" value="添加" class="redB"></div>-->
<!--                    <div class="formAddEmp"><input type="submit" onclick="deleteBill()" value="删除" class="redB"></div>-->
                </div>
                <table  cellpadding="0" cellspacing="0" width="100%" class="sTable">
                    <thead>
                    <tr>
                        <td width="20"><input type="checkbox" onclick="selectAll()"></td>
                        <td width="20">序号</td>
                        <td width="110">资产名</td>
                        <td width="80">承租人</td>
                        <td width="80">电话</td>
                        <td width="80">建筑面积(㎡)</td>
                        <td width="80">租金已缴</td>
                        <td width="80">租金欠费</td>
                        <td width="80">状态</td>
                        <td width="80">支付日期</td>
                        <td width="50">备注</td>
                        <td width="80">交租时间</td>
                    </tr>
                    </thead>
                    <tbody id="myTable">
                    </tbody>
                </table>
            </div>

            <span class="page-new">
                <span id="pagefoot"></span></span>
            <div class="clear"></div>
        </div>

        <!-- 弹窗 -->

        <input type="hidden" id="commit_title_ids"/>
        <input type="hidden" id="commit_matter_ids"/>





    </div>
    <!-- Footer line -->
    <div id="footer">
        <div class="wrapper">Copyright © 2023 沙磁文旅版权所有 </div>
    </div>


    <div class="clear"></div>

    <script type="text/javascript">
        $(function () {
            toggle('asset');
            initData();
        } );


        function logOut() {
            $.ajax({
                type: "GET",
                url: "/logout",
                success: function (res) {
                    if(res && res.code === 200) {
                        localStorage.removeItem('token');
                        layui.layer.msg(res.message,{time:1000},function(){
                            layer.close(); //再执行关闭
                            location.href="/admin";
                        });

                    }
                }
            })
        }
        function index_html() {
            location.href="/admin";
        }
        function userInfo() {
            location.href="/userInfo";
        }
        function login() {
            location.href="/loginAdmin";
        }
        function memberList() {
            location.href="/memberList";
        }
        function costManage() {
            location.href="/costManage";
        }
        function mangeState() {
            location.href="/mangeState";
        }
        function capitalposition() {
            location.href="/capitalList";
        }
        function tasklist(project) {
            localStorage.setItem("project",project);
            location.href="/taskList";
        }
        function hetong() {
            location.href="/contract";
        }
        function fengkong() {
            location.href="/risk";
        }
        function rectify() {
            location.href="/rectify";
        }
        function roleList() {
            location.href="/roleList";
        }
        function authority() {
            location.href="/authority";
        }
        function assetList() {
            location.href="/assetList";
        }
        function lesseList() {
            location.href="/lesseList";
        }
        function leaseInfolist() {
            location.href="/leaseInfolist";
        }
        function rentList() {
            location.href="/rentList";
        }
        function toggle(id) {
            var x = document.getElementById(id);
            if (x.className === "sub ul_hidden") {
                x.className = "sub";
            } else {
                x.className = "sub ul_hidden";
            }
        }
        function initData() {
            var token = localStorage.getItem("token");
            if(token){
                $.ajax({
                    type: "get",
                    url: "/isLogin",
                    headers: {
                        'Authorization': token // 在请求头中添加token
                    },
                    success: function (res) {
                        if(res.code === 200) {
                            // JSON.stringify()
                            document.getElementById("loginUser").innerHTML = "您好！"+res.obj.name;
                            document.getElementById("idNo").innerHTML = "ID号："+res.obj.id;
                            document.getElementById("idName").innerHTML = "姓名："+res.obj.name;
                            document.getElementById("idPhone").innerHTML = "手机："+res.obj.phone;
                            getBillList(1);
                        }else {
                            layui.layer.msg(res.message,{icon:2},{time:1000},function(){
                                layer.close(); //再执行关闭
                                location.reload();
                            });
                        }
                    },
                    error:function (res) {
                        layui.layer.msg(res.message,{icon:2},{time:1000},function(){
                            layer.close(); //再执行关闭
                            location.reload();
                        });
                    }
                })
            }else {
                var info ="您还未登录，暂时无法显示当前页面的敏感数据哟！"+"<a href='#' onclick='login()'>立即登录</a>";
                document.getElementById("messages").innerHTML = info;
            }
        }

        function getBillList(pageNum) {
            $.ajax({
                type: "get",
                url: "/rentBill/getBillList?pageNum="+pageNum,
                headers: {
                    'Authorization': localStorage.getItem("token") // 在请求头中添加token
                },
                data:$('#formId').serialize(),
                success: function (res) {
                    if(res && res.code===200){
                        layer.msg(res.message, { icon: 1,time: 1000});
                        var data = res.obj;
                        var data1 = res.obj.list;
                        var pageNo = parseInt(res.obj.pageNum);
                        var pages = parseInt(res.obj.pages);
                        var total = parseInt(res.obj.total);
                        // 获取表格元素
                        var str_info='';
                        for (var i = 0; i < data1.length; i++) {
                            str_info+='<tr><td align="center"><input class="choose" type="checkbox" value="'+data1[i].id+'"></td>';
                            str_info+='<td align="center">'+data1[i].id+'</td>';
                            str_info+='<td align="center">'+data1[i].assetName+'</td>';
                            str_info+='<td align="center">'+data1[i].lesseeName+'</td>';
                            str_info+='<td align="center">'+data1[i].phone+'</td>';
                            str_info+='<td align="center">'+data1[i].acreage+'</td>';
                            str_info+='<td align="center">'+data1[i].amount+'</td>';
                            str_info+='<td align="center">'+data1[i].amountOwed+'</td>';
                            if(data1[i].status===1){
                                str_info+='<td align="center" id="status_'+data1[i].id+'"><a href="#" style="color: red;text-decoration: none;">已交</a></td>';
                            }else if(data1[i].status===2){
                                str_info+='<td align="center" id="status_'+data1[i].id+'"><a href="#" style="color: red;text-decoration: none;">欠费</a></td>';
                            } else {
                                str_info+='<td align="center" id="status_'+data1[i].id+'"><a href="#"  style="color: green;text-decoration: none;">免租</a></td>';
                            }
                            str_info+='<td align="center">'+(data1[i].rentDay==null?"":dateFormat(1,data1[i].rentDay))+'</td>';
                            str_info+='<td align="center"><div  class="text-over" title="'+(data1[i].remark==null?"":data1[i].remark)+'">'+(data1[i].remark==null?"":data1[i].remark)+'</div></td>';
                            str_info+='<td align="center">'+dateFormat(1,data1[i].addTime)+'</td></tr>';
                        }
                        $("#myTable").html(str_info);

                        pagenum0=pageNo-1;
                        pagenum1=pageNo+1;
                        pagenum2=pageNo+2;
                        pagenum3=pageNo+3;
                        var htm="<a  href='#' onclick='getBillList(1)'>首页 </a>";
                        if(data.pageNum >1){
                            htm+="<a  href='#' onclick='getBillList("+data.prePage+")'>上一页 </a>"
                        }
                        if(pagenum0 >=1){
                            htm+="<a  href='#' onclick='getBillList("+pagenum0+")'><button style='margin: 1px 1px;border: 1px solid;'>"+pagenum0+"</button></a>"
                        }
                        htm+="<button class='current'>"+data.pageNum+"</button>";
                        if(pagenum1 <= pages){
                            htm+="<a  href='#' onclick='getBillList("+pagenum1+")'><button style='margin: 1px 1px;border: 1px solid;'>"+pagenum1 +" </button></a>"
                        }
                        if(pagenum2 <= pages){
                            htm+="<a  href='#' onclick='getBillList("+pagenum2+")'><button style='margin: 1px 1px;border: 1px solid;'>"+pagenum2 +" </button></a>"
                        }
                        if(pagenum3 <= pages){
                            htm+="<a  href='#' onclick='getBillList("+pagenum3+")'><button style='margin: 1px 1px;border: 1px solid;'>"+pagenum3+ "</button> </a>"
                        }
                        htm+="<a  href='#' onclick='getBillList("+data.nextPage+")'> 下一页</a><a  href='#' onclick='getBillList("+data.pages+")'> 尾页</a><span > 共有"+data.pages+"页 </span>"
                        $("#pagefoot").html(htm);
                    }else {
                        //失败提示
                        layer.msg(res.message, {
                            icon: 2,
                            time: 2000
                        });
                    }

                }



            })

        }

        function addRentBill() {
            var html_info=" <div class=\"formRow4\" style='text-align: center'>\n" +
                "                        <span class='formLeft'>名称：</span>\n" +
                "                        <div class=\"formRight\"><input  class=\"validate[required]\"  id=\"assetName\"><span></span></div><div class=\"clear\"></div>\n" +
                "                    </div>\n" +
                "                    <div class=\"formRow4\" style='text-align: center'>\n" +
                "                         <span class='formLeft'>面积(㎡)： </span>\n" +
                "                        <div class=\"formRight\"><input  type=\"number\" step=\"0.01\" placeholder=\"请只输入数字\"   class=\"validate[required]\"  id=\"acreage\"></div><div class=\"clear\"></div>\n" +
                "                    </div>\n" +
                "                    <div class=\"formRow4\" style='text-align: center'>\n" +
                "                       <span class='formLeft'> 地址：</span>\n" +
                "                        <div class=\"formRight\"><input  class=\"validate[required]\"  id=\"address\"><span></span></div><div class=\"clear\"></div>\n" +
                "                    </div>\n" +
                "                    <div class=\"formRow4\" style='text-align: center'>\n" +
                "                       <span class='formLeft'> 状态：</span>\n" +
                "                        <div  class=\"formRight\"><select style='width: 165px;'  id=\"status\">\n" +
                "                            <option value=\"\"></option>\n" +
                "                            <option value=\"1\">空置中</option>\n" +
                "                            <option value=\"2\">租赁中</option>\n" +
                "                        </select></div><div class=\"clear\"></div>\n" +
                "                    </div>\n" +
                "                    <div class=\"formRow4\" style='text-align: center'>\n" +
                "                       <span class='formLeft'> 备注：</span>\n" +
                "                        <div class=\"formRight\"><input  class=\"validate[required]\"  id=\"remark\"><span></span></div><div class=\"clear\"></div>\n" +
                "                    </div>\n" +
                "                    <div><button style=\"margin-left:45%;background: green;color: white;\" onclick=\"addBill()\">提交</button></div>";
            layui.layer.open({
                type:1,
                title:"资产管理",
                skin:"open_css",
                area:['40%','50%'],
                // shadeClose: true, //点击弹出层外空白处
                content:html_info
            })


        }
        function addBill() {
            var assetName = document.getElementById("assetName").value;
            var acreage = document.getElementById("acreage").value;
            var address = document.getElementById("address").value;
            var status = document.getElementById("status").value;
            var remark = document.getElementById("remark").value;
            if(null==assetName||assetName==""){
                layui.layer.msg("名称不能为空！！！！",{icon:2},{time:1000});
                return;
            }
            if(null==acreage||acreage==""){
                layui.layer.msg("面积不能为空！！！！",{icon:2},{time:1000});
                return;
            }
            if(null==address||address==""){
                layui.layer.msg("地址不能为空！！！！",{icon:2},{time:1000});
                return;
            }
            if(null==status||status==""){
                layui.layer.msg("状态不能为空！！！！",{icon:2},{time:1000});
                return;
            }
            $.ajax({
                type: "post",
                url: "/asset/addAsset",
                headers: {
                    'Authorization': localStorage.getItem("token") // 在请求头中添加token
                },
                data:({
                    assetName:assetName,
                    acreage:acreage,
                    address:address,
                    status:status,
                    remark:remark
                }),
                success: function (res) {
                    if(res && res.code===200){
                        layui.layer.msg(res.message,{time:1000},function(){
                            layer.close(); //再执行关闭
                            capitalposition();
                        });

                    }else {
                        layui.layer.msg(res.message,{time:1000});
                    }
                }


            })
        }

        function dateFormat(type,utcTime) {
            var date = new Date(utcTime); // 创建Date对象
            // 获取年、月、日、小时、分钟和秒
            var year = date.getFullYear();
            var month = date.getMonth() + 1; // 月份从0开始，所以要加1
            var day = date.getDate();
            var hours = date.getHours();
            var minutes = date.getMinutes();
            var seconds = date.getSeconds();
            // 将日期和时间组件组合成字符串
            var formatteddate = year + '-' + (month>=10?month:"0"+month) + '-' + (day>=10?day:"0"+day) ;
            var formattedTime = year + '-' + (month>=10?month:"0"+month) + '-' + (day>=10?day:"0"+day) + ' ' + (hours>=10?hours:"0"+hours) + ':'
                + (minutes>=10?minutes:"0"+minutes) + ':' + (seconds>=10?seconds:"0"+seconds);
            if(type==1){
                return formatteddate;
            }else {
                return formattedTime;
            }

        }


        function updateStatus(id,type) {
            let message='';
            let html='';
            if(type===1){
                type=2
                message='您确认要把状态更新成吗?';
                html='<a href="#"  style="color: green;text-decoration: none;" onclick="updateStatus('+id+',2)">租赁中</a>';
            }else {
                type=1
                message='您确认要把状态更新程空置中吗?';
                html='<a href="#" style="color: red;text-decoration: none;"  onclick="updateStatus('+id+',1)">空置中</a>';
            }
            layer.confirm(message, {
                title:'操作提示',
                icon:0,
                btn: ['确定','取消']
            }, function(){
                var index = layer.load();
                $.ajax({
                    url: "/asset/editAsset",
                    headers: {
                        'Authorization': localStorage.getItem("token") // 在请求头中添加token
                    },
                    data: ({
                        id:id,
                        status:type
                    }),
                    type: 'post',
                    success: function (resp) {
                        layer.close(index);
                        //成功提示
                        if (resp.code == 200) {
                            document.getElementById("status_"+id).innerHTML=html;
                            layer.msg("更新成功", {
                                icon: 1,
                                time: 1000
                            }, function () {

                            });
                        } else {
                            //失败提示
                            layer.msg(resp.msg, {
                                icon: 2,
                                time: 2000
                            });
                        }
                    }
                });
            });


        }


        function deleteAsset() {
            var selectedValues = document.querySelectorAll(".choose:checked");
            var ids = [];
            for (var i = 0; i < selectedValues.length; i++) {
                ids.push(selectedValues[i].value);
            }
            if(ids.length==0){
                layui.layer.msg('您沒有勾选资产');
            }else {
                $.ajax({
                    type: "get",
                    url: "/asset/deleteAsset",
                    headers: {
                        'Authorization': localStorage.getItem("token") // 在请求头中添加token
                    },
                    data:{
                        ids:JSON.stringify(ids)
                    },
                    success: function (res) {
                        layui.layer.msg(res.message,{time:1000},function(){
                            layer.close(); //再执行关闭
                            location.reload();
                        });
                    }})


            }
        }
        function selectAll() {
            var checkboxes = document.getElementsByClassName("choose");
            for (var i = 0; i < checkboxes.length; i++) {
                if(checkboxes[i].checked){
                    checkboxes[i].checked=false;
                }else{
                    checkboxes[i].checked= true;
                }

            }
        }

        function exportBill() {
            $.ajax({
                type: "get",
                url: "/rentBill/exportBill",
                headers: {
                    'Authorization': localStorage.getItem("token") // 在请求头中添加token
                },
                success: function (res) {
                    layui.layer.msg(res.message,{time:1000},function(){
                        layer.close(); //再执行关闭
                        if(res.code==200){
                            window.location.href="/rentBill/exportExcel";
                        }
                    });
                }})

        }
    </script>
</body>
</html>