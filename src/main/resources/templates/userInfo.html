<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
    <title>我的资料</title>
    <link href="css/main.css" rel="stylesheet" type="text/css" />
    <link href="css/style_sc.css" rel="stylesheet" type="text/css" />

    <script type="text/javascript" src="js/jquery.min.js"></script>

    <script type="text/javascript" src="js/plugins/spinner/ui.spinner.js"></script>
    <script type="text/javascript" src="js/plugins/spinner/jquery.mousewheel.js"></script>

    <script type="text/javascript" src="js/jquery-ui.min.js"></script>

    <script type="text/javascript" src="js/plugins/charts/excanvas.min.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.flot.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.flot.orderBars.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.flot.pie.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.flot.resize.js"></script>
    <script type="text/javascript" src="js/plugins/charts/jquery.sparkline.min.js"></script>

    <script type="text/javascript" src="js/plugins/forms/uniform.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.cleditor.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.validationEngine-en.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.validationEngine.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.tagsinput.min.js"></script>
    <script type="text/javascript" src="js/plugins/forms/autogrowtextarea.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.maskedinput.min.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.dualListBox.js"></script>
    <script type="text/javascript" src="js/plugins/forms/jquery.inputlimiter.min.js"></script>
    <script type="text/javascript" src="js/plugins/forms/chosen.jquery.min.js"></script>

    <script type="text/javascript" src="js/plugins/wizard/jquery.form.js"></script>
    <script type="text/javascript" src="js/plugins/wizard/jquery.validate.min.js"></script>
    <script type="text/javascript" src="js/plugins/wizard/jquery.form.wizard.js"></script>

    <script type="text/javascript" src="js/plugins/uploader/plupload.js"></script>
    <script type="text/javascript" src="js/plugins/uploader/plupload.html5.js"></script>
    <script type="text/javascript" src="js/plugins/uploader/plupload.html4.js"></script>
    <script type="text/javascript" src="js/plugins/uploader/jquery.plupload.queue.js"></script>

    <script type="text/javascript" src="js/plugins/tables/datatable.js"></script>
    <script type="text/javascript" src="js/plugins/tables/tablesort.min.js"></script>
    <script type="text/javascript" src="js/plugins/tables/resizable.min.js"></script>

    <script type="text/javascript" src="js/plugins/ui/jquery.tipsy.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.collapsible.min.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.prettyPhoto.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.progress.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.timeentry.min.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.colorpicker.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.breadcrumbs.js"></script>
    <script type="text/javascript" src="js/plugins/ui/jquery.sourcerer.js"></script>

    <script type="text/javascript" src="js/plugins/calendar.min.js"></script>
    <script type="text/javascript" src="js/plugins/elfinder.min.js"></script>

<!--    <script type="text/javascript" src="js/custom.js"></script>-->

<!--    <script type="text/javascript" src="js/charts/chart.js"></script>-->

    <!-- Shared on MafiaShare.net  --><!-- Shared on MafiaShare.net  --></head>

<body>

<!-- Left side content -->
<div id="leftSide">
    <div class="logo"><a href="#"><img src="" alt="" /></a></div>

    <div class="sidebarSep mt0"></div>

    <!-- Search widget -->

    <!-- Left navigation -->
    <ul id="menu" class="nav">
        <li class="dash"><a href="#" onclick="index_html()" class="active"><span>首页</span></a></li>
        <li class="charts"><a href="#" title="" onclick="toggle('userManage')" class="exp"><span>系统管理</span></a>
            <ul class="sub ul_hidden" id="userManage">
                <li><a href="" title="">合同履行</a></li>
                <li><a href="#" title="" onclick="mangeState()">经营管理</a></li>
                <li><a href="#" title="" onclick="costManage()">成本管理</a></li>
                <li><a href="#" onclick="memberList()" title="">人事信息</a></li>
                <li><a href="#" title="" onclick="capitalposition()">资金状况</a></li>
                <li><a href="" title="">建设发展</a></li>
            </ul>
        </li>

        <li class="charts"><a href="#" title="" onclick="toggle('taskManage')" class="exp"><span>任务管理</span></a>
            <ul class="sub ul_hidden" id="taskManage">
                <li><a href="#" title="" onclick="tasklist('综合部')">综合部</a></li>
                <li><a href="#" title="" onclick="tasklist('市场部')">市场部</a></li>
                <li><a href="#" title="" onclick="tasklist('财务部')">财务部</a></li>
                <li><a href="#" title="" onclick="tasklist('规建部')">规建部</a></li>
                <li><a href="#" title="" onclick="tasklist('金沙艺术中心')">金沙艺术中心</a></li>
            </ul>
        </li>

        <li class="charts"><a href="#" title="" onclick="toggle('fengKongManage')" class="exp"><span>风控管理</span></a>
            <ul class="sub ul_hidden" id="fengKongManage">
                <li><a href="" title="">涉诉情况</a></li>
                <li><a href="" title="">监督检查整改情况</a></li>
            </ul>
        </li>

        <li class="tables"><a href="#" title="" onclick="toggle('myInfo')"  class="exp"><span>个人档案</span><strong></strong></a>
            <ul class="sub ul_hidden" id="myInfo">
                <li><a href="#" title="" onclick="userInfo()" id="idNo"></a></li>
                <li><a href="#" title="" onclick="userInfo()" id="idName"></a></li>
                <li class="last"><a href="#" title="" onclick="userInfo()" id="idPhone"></a></li>
            </ul>
        </li>
    </ul>
</div>


<!-- Right side -->
<div id="rightSide">

    <!-- Top fixed navigation -->
    <div class="topNav">
        <div class="wrapper">
            <div class="welcome"><a href="#" title=""><img src="images/userPic.png" alt="" /></a><span id="loginUser"></span></div>
            <div class="welcome"><a href="#" title=""></a><span id="messages" style="color: red"></span></div>
            <div class="userNav">
                <ul>
                    <li><a href="#" title=""><img src="images/icons/topnav/logout.png" alt="" /><span onclick="logOut()">退出</span></a></li>
                </ul>
            </div>
            <div class="clear"></div>
        </div>
    </div>

    <!-- Responsive header -->
    <div class="resp">
        <div class="respHead">
            <a href="#" title=""><img src="images/loginLogo.png" alt="" /></a>
        </div>

        <div class="cLine"></div>
        <div class="smalldd">
            <span class="goTo"><img src="images/icons/light/home.png" alt="" />Dashboard</span>
            <ul class="smallDropdown">
                <li><a href="#" title=""><img src="images/icons/light/home.png" alt="" />Dashboard</a></li>
                <li><a href="#" title=""><img src="images/icons/light/stats.png" alt="" />Statistics and charts</a></li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/pencil.png" alt="" />Forms stuff<strong>4</strong></a>
                    <ul>
                        <li><a href="#" title="">Form elements</a></li>
                        <li><a href="#" title="">Validation</a></li>
                        <li><a href="#" title="">WYSIWYG and file uploader</a></li>
                        <li class="last"><a href="#" title="">Wizards</a></li>
                    </ul>
                </li>
                <li><a href="#" title=""><img src="images/icons/light/users.png" alt="" />Interface elements</a></li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/frames.png" alt="" />Tables<strong>3</strong></a>
                    <ul>
                        <li><a href="#" title="">Static tables</a></li>
                        <li><a href="#" title="">Dynamic table</a></li>
                        <li class="last"><a href="#" title="">Sortable &amp; resizable tables</a></li>
                    </ul>
                </li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/fullscreen.png" alt="" />Widgets and grid<strong>2</strong></a>
                    <ul>
                        <li><a href="#" title="">Widgets</a></li>
                        <li class="last"><a href="#" title="">Grid</a></li>
                    </ul>
                </li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/alert.png" alt="" />Error pages<strong>6</strong></a>
                    <ul class="sub">
                        <li><a href="#" title="">403 page</a></li>
                        <li><a href="#" title="">404 page</a></li>
                        <li><a href="#" title="">405 page</a></li>
                        <li><a href="#" title="">500 page</a></li>
                        <li><a href="#" title="">503 page</a></li>
                        <li class="last"><a href="#" title="">Website is offline</a></li>
                    </ul>
                </li>
                <li><a href="#" title=""><img src="images/icons/light/files.png" alt="" />File manager</a></li>
                <li><a href="#" title="" class="exp"><img src="images/icons/light/create.png" alt="" />Other pages<strong>3</strong></a>
                    <ul>
                        <li><a href="#" title="">Typography</a></li>
                        <li><a href="#" title="">Calendar</a></li>
                        <li class="last"><a href="#" title="">Gallery</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="cLine"></div>
    </div>

    <!-- Title area -->
    <div class="titleArea">
        <div class="wrapper">
            <div class="pageTitle">
            </div>
            <div class="middleNav">

                <div class="clear"></div>
            </div>
            <div class="clear"></div>
        </div>
    </div>
    <div class="line"></div>
    <!-- Main content wrapper -->
    <div class="wrapper">

        <!-- Note -->
        <div class="nNote nInformation hideit">
            <p>亲爱的<strong>沙磁文旅 </strong>（Lv1，重庆市地区领导人）</p>
        </div>


        <div class="widget rightTabs">
            <div class="title"><img src="images/icons/dark/stats.png" alt="" class="titleIcon"><h6>我的资料</h6></div>
            <ul class="tabs">
                <li><a href="#tab1">基本信息</a></li>
<!--                <li><a href="#tab4">上传头像</a></li>-->
            </ul>
            <div class="tab_container">
                <div id="tab1" class="tab_content np" style="display: block;">


                            <div class="formRow">
                                <input id="userId" type="hidden"/>
                                <label>我的名字：<span class="req">*</span></label>
                                <div class="formRight"><input type="text" class="validate[required]"  id="userName"></div><div class="clear"></div>
                            </div>

                           <div class="formRow">
                               <label>手机号码：<span class="req">*</span></label>
                               <div class="formRight"><input type="text" class="validate[required]"  id="phone"></div><div class="clear"></div>
                           </div>

                            <div class="formRow">
                                <label>密码(已加密)：<span class="req">*</span></label>
                                <div class="formRight"><input type="text" class="validate[required,custom[onlyNumberSp]]"  id="passWord"></div><div class="clear"></div>
                            </div>
                            <div class="formSubmit"><input type="submit" onclick="editInfo()" value="修改" class="redB"></div>
                            <div class="clear"></div>
                     <

                </div>
                <div id="tab2" class="tab_content np" style="display: none;">
                    <form id="validate" class="form" method="post" action="">
                        <fieldset>
                            <div class="formRow">
                                <label>原密码：<span class="req">*</span></label>
                                <div class="formRight"><input type="text" class="validate[required]" name="req" id="req"></div><div class="clear"></div>
                            </div>
                            <div class="formRow">
                                <label>新密码：<span class="req">*</span></label>
                                <div class="formRight"><input type="text" class="validate[required]" name="password1" id="password1"></div><div class="clear"></div>
                            </div>
                            <div class="formRow">
                                <label>确认密码：<span class="req">*</span></label>
                                <div class="formRight"><input type="text" class="validate[required,minSize[6]]" name="minValid" id="minValid"></div><div class="clear"></div>
                            </div>
                            <div class="formSubmit"><input type="submit" value="修改" class="redB"></div>
                            <div class="clear"></div>
                        </fieldset>
                    </form>
                </div>
                <div id="tab3" class="tab_content np" style="display: none;">
                    <form id="validate" class="form" method="post" action="">
                        <fieldset>
                            <div class="formRow">
                                <label>原安全密码：<span class="req">*</span></label>
                                <div class="formRight"><input type="text" class="validate[required]" name="req" id="req"></div><div class="clear"></div>
                            </div>
                            <div class="formRow">
                                <label>新安全密码：<span class="req">*</span></label>
                                <div class="formRight"><input type="text" class="validate[required]" name="password1" id="password1"></div><div class="clear"></div>
                            </div>
                            <div class="formRow">
                                <label>确认新密码：<span class="req">*</span></label>
                                <div class="formRight"><input type="text" class="validate[required,minSize[6]]" name="minValid" id="minValid"></div><div class="clear"></div>
                            </div>
                            <div class="formSubmit"><input type="submit" value="修改" class="redB"></div>
                            <div class="clear"></div>
                        </fieldset>
                    </form>
                </div>
                <div id="tab4" class="tab_content np" style="display: none;">
                    <form id="validate" class="form" method="post" action="">
                        <fieldset>
                            <div class="formRow">
                                <label>上传头像<span class="req">*</span></label>
                                <div class="formRight"><input type="file" class="validate[required]" name="req" id="req"></div><div class="clear"></div>
                            </div>
                            <div class="formSubmit"><input type="submit" value="修改" class="redB"></div>
                            <div class="clear"></div>
                        </fieldset>
                    </form>
                </div>
            </div>
        </div>


    </div>

    <!-- Footer line -->
    <div id="footer">
        <div class="wrapper">Copyright © 2023 沙磁文旅版权所有 </div>-->
    </div>

</div>

<div class="clear"></div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">

    $(function () {
        initData();
    } );
    function logOut() {
        $.ajax({
            type: "GET",
            url: "/logout",
            success: function (res) {
                if(res && res.code === 200) {
                    localStorage.removeItem('token');
                    alert(res.message);
                    location.href="/admin";
                }
            }
        })
    }
    function index_html() {
        location.href="/admin";
    }
    function userInfo() {
        location.href="/userInfo";
    }
    function login() {
        location.href="/";
    }
    function memberList() {
        location.href="/memberList";
    }
    function costManage() {
        location.href="/costManage";
    }
    function mangeState() {
        location.href="/mangeState";
    }
    function capitalposition() {
        location.href="/capitalList";
    }
    function tasklist(project) {
        localStorage.setItem("project",project);
        location.href="/taskList";
    }

    function toggle(id) {
        var x = document.getElementById(id);
        if (x.className === "sub ul_hidden") {
            x.className = "sub";
        } else {
            x.className = "sub ul_hidden";
        }
    }
    function initData() {
        var token = localStorage.getItem("token");
        if(token){
            $.ajax({
                type: "get",
                url: "/isLogin",
                headers: {
                    'Authorization': token // 在请求头中添加token
                },
                success: function (res) {
                    if(res.code === 200) {
                        document.getElementById("loginUser").innerHTML = "您好！"+res.obj.name;
                        document.getElementById("idNo").innerHTML = "ID号："+res.obj.id;
                        document.getElementById("idName").innerHTML = "姓名："+res.obj.name;
                        document.getElementById("idPhone").innerHTML = "手机："+res.obj.phone;
                        document.getElementById("userId").value = res.obj.id;
                        document.getElementById("userName").value = res.obj.name;
                        // document.getElementById("passWord").value = res.obj.password;
                        document.getElementById("phone").value = res.obj.phone;
                    }else {
                        alert(res.message)
                    }
                },
                error:function (res) {
                    alert(res.message)
                }
            })
        }else {
            var info ="您还未登录，暂时无法显示当前页面的敏感数据哟！"+"<a href='#' onclick='login()'>立即登录</a>";
            document.getElementById("messages").innerHTML = info;
        }
    }


    function editInfo() {
        var id = document.getElementById("userId").value;
        var username = document.getElementById("userName").value;
        var password = document.getElementById("passWord").value;
        var phone = document.getElementById("phone").value;
        $.ajax({
            type: "get",
            url: "/editUser",
            headers: {
                'Authorization':  localStorage.getItem("token") // 在请求头中添加token
            },
            data:({
                id:id,
                name:username,
                password:password,
                phone:phone
             }),
            success: function (res) {
                if(res.code === 200) {
                    alert(res.message)
                }else {
                    alert(res.message)
                }
            }
        })
    }

</script>
</body>
</html>